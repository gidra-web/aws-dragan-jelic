# nginx.conf
# This file configures Nginx to serve your React Single-Page Application (SPA).

server {
    # Nginx will listen for incoming HTTP connections on port 80.
    listen 80;

    # The server_name directive defines the domain names that this server block handles.
    # For local development, 'localhost' is fine. In production, replace with your domain.
    server_name localhost;

    # Specifies the root directory from which files will be served.
    # This is where your React build output (index.html, static/js, static/css) will be.
    root /usr/share/nginx/html;

    # Specifies the default files to try when a directory is requested.
    # In a React SPA, index.html is the entry point.
    index index.html index.htm;

    # This is the crucial part for Single-Page Applications (SPAs) like React.
    # It tells Nginx how to handle requests for paths that don't directly map to a file.
    location / {
        # 1. Try to serve the requested URI directly (e.g., if /static/js/main.js is requested)
        # 2. If it's a directory, try to serve index.html within that directory.
        # 3. If neither of the above, fall back to serving /index.html.
        #    This is essential for client-side routing, as all routes should load your React app.
        try_files $uri $uri/ /index.html;
    }

    # Optional: Configure caching for static assets (JS, CSS, images).
    # This helps improve performance by telling browsers to cache these files.
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        # Set cache expiration to 30 days.
        expires 30d;
        # Add Cache-Control header to specify caching directives.
        add_header Cache-Control "public, no-transform";
    }

    # Configure error pages.
    # If a 500, 502, 503, or 504 error occurs, serve the custom 500.html page.
    error_page 500 502 503 504 /500.html;
    # Define the location for the custom 500.html page.
    location = /500.html {
        root /usr/share/nginx/html;
    }
}